@page "/caregiver/list/create"
@inject IEmployeeService EmployeeService
@inject NavigationManager Navigation
@rendermode InteractiveServer

<PageTitle>@(isEdit ? "Edit" : "Add") Employee - QHMCPro</PageTitle>

<div class="page-header">
    <div class="page-header-left">
        <h1>@(isEdit ? "Edit Employee" : "Add New Employee")</h1>
    </div>
    <div class="page-header-actions"><button class="btn btn-outline"
            @onclick='() => Navigation.NavigateTo("/caregiver/list")'><i class="fa fa-arrow-left"></i> Back</button>
    </div>
</div>

<div class="card">
    <div class="card-header">
        <h3><i class="fa fa-user" style="margin-right: 8px;"></i> Employee Information</h3>
    </div>
    <div class="card-body">
        <EditForm Model="model" OnValidSubmit="Save">
            <DataAnnotationsValidator />
            <div class="form-row">
                <div class="form-group"><label class="form-label">First Name *</label>
                    <InputText @bind-Value="model.FirstName" class="form-control" />
                </div>
                <div class="form-group"><label class="form-label">Last Name *</label>
                    <InputText @bind-Value="model.LastName" class="form-control" />
                </div>
                <div class="form-group"><label class="form-label">Email</label>
                    <InputText @bind-Value="model.Email" class="form-control" />
                </div>
            </div>
            <div class="form-row">
                <div class="form-group"><label class="form-label">Phone</label>
                    <InputText @bind-Value="model.Phone" class="form-control" />
                </div>
                <div class="form-group"><label class="form-label">Date of Birth</label>
                    <InputDate @bind-Value="model.DateOfBirth" class="form-control" />
                </div>
                <div class="form-group"><label class="form-label">Gender</label>
                    <InputSelect @bind-Value="model.Gender" class="form-control">
                        <option value="">Select</option>
                        <option>Male</option>
                        <option>Female</option>
                        <option>Other</option>
                    </InputSelect>
                </div>
            </div>
            <div class="form-row">
                <div class="form-group"><label class="form-label">Job Title</label>
                    <InputText @bind-Value="model.JobTitle" class="form-control" />
                </div>
                <div class="form-group"><label class="form-label">Department</label>
                    <InputText @bind-Value="model.Department" class="form-control" />
                </div>
                <div class="form-group"><label class="form-label">Hire Date</label>
                    <InputDate @bind-Value="model.HireDate" class="form-control" />
                </div>
            </div>
            <div class="form-row">
                <div class="form-group"><label class="form-label">Pay Rate ($)</label>
                    <InputNumber @bind-Value="model.PayRate" class="form-control" />
                </div>
                <div class="form-group"><label class="form-label">Pay Type</label>
                    <InputSelect @bind-Value="model.PayType" class="form-control">
                        <option value="">Select</option>
                        <option>Hourly</option>
                        <option>Salary</option>
                        <option>Per Visit</option>
                    </InputSelect>
                </div>
                <div class="form-group"><label class="form-label">Status</label>
                    <InputSelect @bind-Value="model.Status" class="form-control">
                        <option>Active</option>
                        <option>Inactive</option>
                        <option>On Leave</option>
                        <option>Terminated</option>
                    </InputSelect>
                </div>
            </div>
            <div class="form-group"><label class="form-label">Address</label>
                <InputText @bind-Value="model.Address" class="form-control" />
            </div>
            <div class="form-row">
                <div class="form-group"><label class="form-label">City</label>
                    <InputText @bind-Value="model.City" class="form-control" />
                </div>
                <div class="form-group"><label class="form-label">State</label>
                    <InputText @bind-Value="model.State" class="form-control" />
                </div>
                <div class="form-group"><label class="form-label">Zip</label>
                    <InputText @bind-Value="model.ZipCode" class="form-control" />
                </div>
            </div>
            <div class="form-row">
                <div class="form-group"><label class="form-label">License Number</label>
                    <InputText @bind-Value="model.LicenseNumber" class="form-control" />
                </div>
                <div class="form-group"><label class="form-label">License Expiry</label>
                    <InputDate @bind-Value="model.LicenseExpiry" class="form-control" />
                </div>
                <div class="form-group"><label class="form-label">Certification Expiry</label>
                    <InputDate @bind-Value="model.CertificationExpiry" class="form-control" />
                </div>
            </div>
            <div class="form-group"><label class="form-label">Skills</label>
                <InputTextArea @bind-Value="model.Skills" class="form-control" rows="2" />
            </div>
            <div class="form-group"><label class="form-label">Certifications</label>
                <InputTextArea @bind-Value="model.Certifications" class="form-control" rows="2" />
            </div>
            <div class="form-group"><label class="form-label">Notes</label>
                <InputTextArea @bind-Value="model.Notes" class="form-control" rows="3" />
            </div>
            <div style="display: flex; gap: 12px; margin-top: 24px;">
                <button type="submit" class="btn btn-primary"><i class="fa fa-save"></i> @(isEdit ? "Update" : "Create")
                    Employee</button>
                <button type="button" class="btn btn-outline"
                    @onclick='() => Navigation.NavigateTo("/caregiver/list")'>Cancel</button>
            </div>
        </EditForm>
    </div>
</div>

@code {
    [SupplyParameterFromQuery] public int? Id { get; set; }
    private Employee model = new(); private bool isEdit;
    protected override async Task OnInitializedAsync()
    {
        if (Id.HasValue)
        {
            var e = await
    EmployeeService.GetByIdAsync(Id.Value); if (e != null) { model = e; isEdit = true; }
        }
    }
    private async Task Save()
    {
        if (isEdit) await EmployeeService.UpdateAsync(model);
        else await
    EmployeeService.CreateAsync(model); Navigation.NavigateTo("/caregiver/list");
    }
}
